function utf8Decode(d){var c=[],a=0,f=d.length,b,e,g;while(a<f)b=d[a],e=d[a+1],g=d[a+2],128>b?(c.push(String.fromCharCode(b)),a+=1):191<b&&b<224?(c.push(String.fromCharCode((b&31)<<6|e&63)),a+=2):(c.push(String.fromCharCode((b&15)<<12|(e&63)<<6|g&63)),a+=3);return c.join('');}function utf8Encode(b){var d=[],a=0,e,c;b=encodeURI(b),e=b.length;while(a<e)c=b[a],a+=1,'%'!==c?d.push(c.charCodeAt(0)):(c=b[a]+b[a+1],d.push(parseInt(c,16)),a+=2);return d;}function rgb2ycbcr(a,b,c){return[0.299*a+0.587*b+0.114*c,128-0.168736*a-0.331264*b+0.5*c,128+0.5*a-0.418688*b-0.081312*c];}function ycbcr2rgb(a,b,c){return[a+1.402*(c-128),a-0.344136*(b-128)-0.714136*(c-128),a+1.772*(b-128)];}function get_hashed_order(b,f){var g=13103574579095114000;var c=Array.from(Array(f).keys());b=String(CryptoJS.SHA512(b));var h=b.length;var d=[];var e;for(var a=f;a>0;a--)e=b.charCodeAt(a%h)*g%a,d.push(c[e]),c[e]=c[a-1];return d;}function dct(i){var e=Array(64).fill(0);var g,h,f;for(var a=0;a<8;a++)for(var b=0;b<8;b++){g=a==0?1/Math.sqrt(2):1,h=b==0?1/Math.sqrt(2):1,f=0;for(var c=0;c<8;c++)for(var d=0;d<8;d++)f+=i[c*8+d]*Math.cos((2*c+1)*a*Math.PI/16)*Math.cos((2*d+1)*b*Math.PI/16);e[a*8+b]=1/4*g*h*f;}return e;}function idct(h){result=Array(64).fill(0);var f,g,e;for(var c=0;c<8;c++)for(var d=0;d<8;d++){e=0;for(var a=0;a<8;a++)for(var b=0;b<8;b++)f=a==0?1/Math.sqrt(2):1,g=b==0?1/Math.sqrt(2):1,e+=f*g*h[a*8+b]*Math.cos((2*c+1)*a*Math.PI/16)*Math.cos((2*d+1)*b*Math.PI/16);result[c*8+d]=1/4*e;}return result;}function quantization_matrix(c){var b=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var a=0;a<64;a++)b[a]*=c;return b;}function quantize_diff(j,b,i,f){if(b.length!=f.length)throw'LOC and ENCODE_BITS have different sizes! This is a bug in code!';var g=quantization_matrix(j);var h=Array(64).fill(0);var d,c,e;for(var a=0;a<b.length;a++)d=i[b[a]]/g[b[a]],c=Math.floor(d),Math.abs(c%2)!=f[a]&&(c-=1),e=Math.ceil(d),Math.abs(e%2)!=f[a]&&(e+=1),d-c>e-d&&(c=e),h[b[a]]=c*g[b[a]]-i[b[a]];return h;}function get_bit_from_quantized(e,b,f){var d=quantization_matrix(e);var c=[];for(var a=0;a<b.length;a++)c.push(Math.abs(Math.round(f[b[a]]/d[b[a]])%2));return c;}function img_16x16_to_8x8(c){var d=Array(64);for(var a=0;a<8;a++)for(var b=0;b<8;b++)d[a*8+b]=(c[a*2*8+b*2]+c[(a*2+1)*8+b*2]+c[a*2*8+b*2+1]+c[(a*2+1)*8+b*2+1])/4;return d;}function img_8x8_to_16x16(d){var c=Array(256);for(var a=0;a<16;a++)for(var b=0;b<16;b++)c[a*16+b]=d[Math.floor(a/2)*8+Math.floor(b/2)];return c;}function rgbclip(a){return a=Math.round(a),a=a>255?255:a,a<0?0:a;}function str_to_bits(h,f){var e=utf8Encode(h);var d=Array();var g=e.length;for(var b=0;b<g;b++)for(var a=128;a>0;a=Math.floor(a/2))if(Math.floor(e[b]/a)){for(var c=0;c<f;c++)d.push(1);e[b]-=a;}else for(var c=0;c<f;c++)d.push(0);for(var a=0;a<24;a++)for(var b=0;b<f;b++)d.push(1);return d;}function bits_to_str(g,e){function i(d){var b=d.length;var c=0;for(var a=0;a<b;a++)c+=d[a];return Math.round(c/b);}var f=Array();var c,d;var h=Math.floor(Math.floor(g.length/e)/8);for(var a=0;a<h;a++){c=0,d=128;for(var b=0;b<8;b++)c+=i(g.slice((a*8+b)*e,(a*8+b+1)*e))*d,d=Math.floor(d/2);if(c==255)break;f.push(c);}return utf8Decode(f);}function extract_block(e,a,f,g,h){var d=Array(a*a);for(var b=0;b<a;b++)for(var c=0;c<a;c++)d[b*a+c]=e[(f+b)*h+g+c];return d;}function replace_block(d,c,e,f,g,h){for(var a=0;a<c;a++)for(var b=0;b<c;b++)d[(e+a)*g+f+b]=h[a*c+b];}function prepare_write_data(d,g,b){var e=d.length;if(d.length>b)throw'Can not hold this many data!';var c=Array(b);for(var a=0;a<b;a++)c[a]=Math.floor(Math.random()*2);var f=get_hashed_order(g,b);for(var a=0;a<e;a++)c[f[a]]=d[a];return c;}function write_dct_y(i,g,o,j,p,k){var h=Math.floor(o/8);var d=Math.floor(g/8);var e=k.length;if(e*(h*d-1)!=j.length)throw'Image size does not match data size (Y channel)';var l;for(var a=0;a<h;a++)for(var b=0;b<d;b++){var f=extract_block(i,8,a*8,b*8,g);var c=dct(f);if(a==0&&b==0){l=c;continue;}var m=c.map(function(a,b){return a-l[b];});var n=quantize_diff(p,k,m,j.slice(e*(a*d+b-1),e*(a*d+b)));c=c.map(function(a,b){return a+n[b];}),f=idct(c),replace_block(i,8,a*8,b*8,g,f);}}function write_dct_CbCr(k,h,r,l,s,m){var i=Math.floor(r/16);var d=Math.floor(h/16);var f=m.length;if(f*(i*d-1)!=l.length)throw'Image size does not match data size (CbCr channel)';var n;for(var a=0;a<i;a++)for(var b=0;b<d;b++){var e=extract_block(k,16,a*16,b*16,h);var j=img_16x16_to_8x8(e);var c=dct(j);if(a==0&&b==0){n=c;continue;}var o=c.map(function(a,b){return a-n[b];});var p=quantize_diff(s,m,o,l.slice(f*(a*d+b-1),f*(a*d+b)));c=c.map(function(a,b){return a+p[b];});var q=idct(c);var g=q.map(function(a,b){return a-j[b];});g=img_8x8_to_16x16(g),e=e.map(function(a,b){return a+g[b];}),replace_block(k,16,a*16,b*16,h,e);}}function write_lsb(b,d){function e(a){return a%2==1?a-1:a;}function f(a){return a%2==1?a:a+1;}var c=0;for(var a=0;a<b.data.length;a+=4)b.data[a]=d[c]?f(b.data[a]):e(b.data[a]),b.data[a+1]=d[c+1]?f(b.data[a+1]):e(b.data[a+1]),b.data[a+2]=d[c+2]?f(b.data[a+2]):e(b.data[a+2]),b.data[a+3]=255,c+=3;}function dct_data_capacity(b,c,d,g,h){var e=g?(Math.floor(c/8)*Math.floor(b/8)-1)*d.length:0;var a=h?16:8;var f=(Math.floor(c/a)*Math.floor(b/a)-1)*d.length;return[e,f];}function write_dct(b,f,g,n,o,h,r,s){var p=dct_data_capacity(f,g,h,r,s);var c=p[0];var d=p[1];var i=Array(),j=Array(),k=Array();for(var a=0;a<b.data.length;a+=4){var l=rgb2ycbcr(b.data[a],b.data[a+1],b.data[a+2]);i.push(l[0]),j.push(l[1]),k.push(l[2]);}r&&write_dct_y(i,f,g,n.slice(0,c),o,h);var q=s?write_dct_CbCr:write_dct_y;q(j,f,g,n.slice(c,c+d),o,h),q(k,f,g,n.slice(c+d,c+d+d),o,h);var e=0;for(var a=0;a<b.data.length;a+=4){var m=ycbcr2rgb(i[e],j[e],k[e]);b.data[a]=rgbclip(m[0]),b.data[a+1]=rgbclip(m[1]),b.data[a+2]=rgbclip(m[2]),e+=1;}}function writeMsgToCanvas_base(n,o,h,b,i,j,c,d,e){b=b===undefined?!1:b,h=h===undefined?'':h,i=i===undefined?5:i,j=j===undefined?30:j,c=c===undefined?[1,2,8,9,10,16,17]:c,d=d===undefined?!0:d,e=e===undefined?!0:e;try{var a=document.getElementById(n);var k=a.getContext('2d');var f=k.getImageData(0,0,a.width,a.height);var l=Math.floor(f.data.length/4)*3;if(b){var m=dct_data_capacity(a.width,a.height,c,d,e);l=m[0]+2*m[1];}var g=str_to_bits(o,i);return g=prepare_write_data(g,h,l),b?write_dct(f,a.width,a.height,g,j,c,d,e):write_lsb(f,g),k.putImageData(f,0,0),!0;}catch(err){return err;}}function prepare_read_data(d,f){var b=d.length;var c=Array(b);var e=get_hashed_order(f,b);for(var a=0;a<b;a++)c[a]=d[e[a]];return c;}function get_bits_lsb(c){var b=Array();for(var a=0;a<c.data.length;a+=4)b.push(c.data[a]%2==1?1:0),b.push(c.data[a+1]%2==1?1:0),b.push(c.data[a+2]%2==1?1:0);return b;}function get_dct_y(k,e,l,m,f){var g=Math.floor(l/8);var h=Math.floor(e/8);var n=f.length;var c=Array();var i;for(var a=0;a<g;a++)for(var b=0;b<h;b++){var j=extract_block(k,8,a*8,b*8,e);var d=dct(j);if(a==0&&b==0){i=d;continue;}c.push(get_bit_from_quantized(m,f,d.map(function(a,b){return a-i[b];})));}return[].concat.apply([],c);}function get_dct_CbCr(k,f,l,m,g){var h=Math.floor(l/16);var i=Math.floor(f/16);var n=g.length;var d=Array();var j;for(var a=0;a<h;a++)for(var b=0;b<i;b++){var c=extract_block(k,16,a*16,b*16,f);c=img_16x16_to_8x8(c);var e=dct(c);if(a==0&&b==0){j=e;continue;}d.push(get_bit_from_quantized(m,g,e.map(function(a,b){return a-j[b];})));}return[].concat.apply([],d);}function get_bits_dct(c,e,f,g,h,m,n){var i=Array(),j=Array(),k=Array(),b=Array();for(var a=0;a<c.data.length;a+=4){var d=rgb2ycbcr(c.data[a],c.data[a+1],c.data[a+2]);i.push(d[0]),j.push(d[1]),k.push(d[2]);}m&&b.push(get_dct_y(i,e,f,g,h));var l=n?get_dct_CbCr:get_dct_y;return b.push(l(j,e,f,g,h)),b.push(l(k,e,f,g,h)),[].concat.apply([],b);}function readMsgFromCanvas_base(m,b,c,d,e,f,g,h){c=c===undefined?!1:c,b=b===undefined?'':b,d=d===undefined?5:d,e=e===undefined?30:e,f=f===undefined?[1,2,8,9,10,16,17]:f,g=g===undefined?!0:g,h=h===undefined?!0:h;var a,l,j;try{a=document.getElementById(m),l=a.getContext('2d'),j=l.getImageData(0,0,a.width,a.height);}catch(err){return[false,err];}try{var i=c?get_bits_dct(j,a.width,a.height,e,f,g,h):get_bits_lsb(j);i=prepare_read_data(i,b);var k=bits_to_str(i,d);return k==null?[!1,'Message does not decrypt. Maybe due to (1) wrong password / enc method. (2) corrupted file']:[!0,k];}catch(err){return[false,'Message does not decrypt. Maybe due to (1) wrong password / enc method. (2) corrupted file'];}}function writeMsgToCanvas(a,b,c,d){d=d===undefined?0:parseInt(d);switch(d){case 1:return writeMsgToCanvas_base(a,b,c,!0,11,2,[2,9,16],!0,!1);case 2:return writeMsgToCanvas_base(a,b,c,!0,11,2.5,[1,2,8],!0,!1);case 3:return writeMsgToCanvas_base(a,b,c,!0,11,3,[0,1],!0,!1);case 4:return writeMsgToCanvas_base(a,b,c,!0,5,4,[0],!0,!1);case 5:return writeMsgToCanvas_base(a,b,c,!0,5,6,[0],!0,!0);case 0:default:return writeMsgToCanvas_base(a,b,c,!1,1);}}function readMsgFromCanvas(a,b,c){c=c===undefined?0:parseInt(c);switch(c){case 1:return readMsgFromCanvas_base(a,b,!0,11,2,[2,9,16],!0,!1)[1];case 2:return readMsgFromCanvas_base(a,b,!0,11,2.5,[1,2,8],!0,!1)[1];case 3:return readMsgFromCanvas_base(a,b,!0,11,3,[0,1],!0,!1)[1];case 4:return readMsgFromCanvas_base(a,b,!0,5,4,[0],!0,!1)[1];case 5:return readMsgFromCanvas_base(a,b,!0,5,6,[0],!0,!0)[1];case 0:default:return readMsgFromCanvas_base(a,b,!1,1)[1];}}function loadIMGtoCanvas(e,f,g,a){a=a===undefined?0:a;var b=document.getElementById(e);if(b.files&&b.files[0]){var d=b.files[0];var c=new FileReader();c.onload=function(d){var c=d.target.result;var b=new Image();b.onload=function(){var c=b.width;var d=b.height;a>0&&(c>a&&(d*=a/c,c=a),d>a&&(c*=a/d,d=a),c=Math.floor(c),d=Math.floor(d));var e=document.createElement('canvas');e.id=f,e.width=c,e.height=d,e.style.display='none';var h=document.getElementsByTagName('body')[0];h.appendChild(e);var i=e.getContext('2d');i.drawImage(b,0,0,b.width,b.height,0,0,c,d),g(),document.body.removeChild(e);},b.src=c;},c.readAsDataURL(d);}else return alert('NO IMG FILE SELECTED'),'ERROR PROCESSING IMAGE!';}var CryptoJS=CryptoJS||function(c,m){var d={},e=d.lib={},g=function(){},a=e.Base={extend:function(b){g.prototype=this;var a=new g();return b&&a.mixIn(b),a.hasOwnProperty('init')||(a.init=function(){a.$super.init.apply(this,arguments);}),a.init.prototype=a,a.$super=this,a;},create:function(){var a=this.extend();return a.init.apply(a,arguments),a;},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty('toString')&&(this.toString=a.toString);},clone:function(){return this.init.prototype.extend(this);}},b=e.WordArray=a.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=b!=m?b:4*a.length;},toString:function(a){return(a||j).stringify(this);},concat:function(b){var c=this.words,d=b.words,e=this.sigBytes;if(b=b.sigBytes,this.clamp(),e%4)for(var a=0;a<b;a++)c[e+a>>>2]|=(d[a>>>2]>>>24-8*(a%4)&255)<<24-8*((e+a)%4);else if(65535<d.length)for(a=0;a<b;a+=4)c[e+a>>>2]=d[a>>>2];else c.push.apply(c,d);return this.sigBytes+=b,this;},clamp:function(){var b=this.words,a=this.sigBytes;b[a>>>2]&=4294967295<<32-8*(a%4),b.length=c.ceil(a/4);},clone:function(){var b=a.clone.call(this);return b.words=this.words.slice(0),b;},random:function(e){for(var a=[],d=0;d<e;d+=4)a.push(4294967296*c.random()|0);return new b.init(a,e);}}),f=d.enc={},j=f.Hex={stringify:function(b){var e=b.words;b=b.sigBytes;for(var c=[],a=0;a<b;a++){var d=e[a>>>2]>>>24-8*(a%4)&255;c.push((d>>>4).toString(16)),c.push((d&15).toString(16));}return c.join('');},parse:function(e){for(var c=e.length,d=[],a=0;a<c;a+=2)d[a>>>3]|=parseInt(e.substr(a,2),16)<<24-4*(a%8);return new b.init(d,c/2);}},h=f.Latin1={stringify:function(b){var d=b.words;b=b.sigBytes;for(var c=[],a=0;a<b;a++)c.push(String.fromCharCode(d[a>>>2]>>>24-8*(a%4)&255));return c.join('');},parse:function(e){for(var c=e.length,d=[],a=0;a<c;a++)d[a>>>2]|=(e.charCodeAt(a)&255)<<24-8*(a%4);return new b.init(d,c);}},k=f.Utf8={stringify:function(a){try{return decodeURIComponent(escape(h.stringify(a)));}catch(b){throw Error('Malformed UTF-8 data');}},parse:function(a){return h.parse(unescape(encodeURIComponent(a)));}},i=e.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new b.init(),this._nDataBytes=0;},_append:function(a){'string'==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes;},_process:function(a){var g=this._data,i=g.words,d=g.sigBytes,h=this.blockSize,e=d/(4*h),e=a?c.ceil(e):c.max((e|0)-this._minBufferSize,0);if(a=e*h,d=c.min(4*a,d),a){for(var f=0;f<a;f+=h)this._doProcessBlock(i,f);f=i.splice(0,a),g.sigBytes-=d;}return new b.init(f,d);},clone:function(){var b=a.clone.call(this);return b._data=this._data.clone(),b;},_minBufferSize:0});e.Hasher=i.extend({cfg:a.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset();},reset:function(){i.reset.call(this),this._doReset();},update:function(a){return this._append(a),this._process(),this;},finalize:function(a){return a&&this._append(a),this._doFinalize();},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b);};},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b);};}});var l=d.algo={};return d;}(Math);(function(e){var a=CryptoJS,c=a.lib,b=c.Base,d=c.WordArray,a=a.x64={};a.Word=b.extend({init:function(a,b){this.high=a,this.low=b;}}),a.WordArray=b.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=b!=e?b:8*a.length;},toX32:function(){for(var c=this.words,f=c.length,a=[],b=0;b<f;b++){var e=c[b];a.push(e.high),a.push(e.low);}return d.create(a,this.sigBytes);},clone:function(){for(var d=b.clone.call(this),c=d.words=this.words.slice(0),e=c.length,a=0;a<e;a++)c[a]=c[a].clone();return d;}});}(),function(e,f,c,b,h,i,d,g){function a(){return b.create.apply(b,arguments);}for(e=CryptoJS,f=e.lib.Hasher,c=e.x64,b=c.Word,h=c.WordArray,c=e.algo,i=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],d=[],g=0;80>g;g++)d[g]=a();c=c.SHA512=f.extend({_doReset:function(){this._hash=new h.init([new b.init(1779033703,4089235720),new b.init(3144134277,2227873595),new b.init(1013904242,4271175723),new b.init(2773480762,1595750129),new b.init(1359893119,2917565137),new b.init(2600822924,725511199),new b.init(528734635,4215389547),new b.init(1541459225,327033209)]);},_doProcessBlock:function($,a0){for(var e=this._hash.words,A=e[0],B=e[1],C=e[2],D=e[3],E=e[4],F=e[5],G=e[6],e=e[7],S=A.high,H=A.low,T=B.high,I=B.low,U=C.high,J=C.low,V=D.high,K=D.low,W=E.high,L=E.low,X=F.high,M=F.low,Y=G.high,N=G.low,Z=e.high,O=e.low,j=S,f=H,s=T,q=I,t=U,r=J,P=V,u=K,k=W,g=L,y=X,v=M,z=Y,w=N,Q=Z,x=O,m=0;80>m;m++){var n=d[m];if(16>m)var c=n.high=$[a0+2*m]|0,a=n.low=$[a0+2*m+1]|0;else{var c=d[m-15],a=c.high,l=c.low,c=(a>>>1|l<<31)^(a>>>8|l<<24)^a>>>7,l=(l>>>1|a<<31)^(l>>>8|a<<24)^(l>>>7|a<<25),p=d[m-2],a=p.high,b=p.low,p=(a>>>19|b<<13)^(a<<3|b>>>29)^a>>>6,b=(b>>>19|a<<13)^(b<<3|a>>>29)^(b>>>6|a<<26),a=d[m-7],R=a.high,o=d[m-16],h=o.high,o=o.low,a=l+a.low,c=c+R+(a>>>0<l>>>0?1:0),a=a+b,c=c+p+(a>>>0<b>>>0?1:0),a=a+o,c=c+h+(a>>>0<o>>>0?1:0);n.high=c,n.low=a;}var R=k&y^~k&z,o=g&v^~g&w,n=j&s^j&t^s&t,a1=f&q^f&r^q&r,l=(j>>>28|f<<4)^(j<<30|f>>>2)^(j<<25|f>>>7),p=(f>>>28|j<<4)^(f<<30|j>>>2)^(f<<25|j>>>7),b=i[m],a2=b.high,_=b.low,b=x+((g>>>14|k<<18)^(g>>>18|k<<14)^(g<<23|k>>>9)),h=Q+((k>>>14|g<<18)^(k>>>18|g<<14)^(k<<23|g>>>9))+(b>>>0<x>>>0?1:0),b=b+o,h=h+R+(b>>>0<o>>>0?1:0),b=b+_,h=h+a2+(b>>>0<_>>>0?1:0),b=b+a,h=h+c+(b>>>0<a>>>0?1:0),a=p+a1,n=l+n+(a>>>0<p>>>0?1:0),Q=z,x=w,z=y,w=v,y=k,v=g,g=u+b|0,k=P+h+(g>>>0<u>>>0?1:0)|0,P=t,u=r,t=s,r=q,s=j,q=f,f=b+a|0,j=h+n+(f>>>0<b>>>0?1:0)|0;}H=A.low=H+f,A.high=S+j+(H>>>0<f>>>0?1:0),I=B.low=I+q,B.high=T+s+(I>>>0<q>>>0?1:0),J=C.low=J+r,C.high=U+t+(J>>>0<r>>>0?1:0),K=D.low=K+u,D.high=V+P+(K>>>0<u>>>0?1:0),L=E.low=L+g,E.high=W+k+(L>>>0<g>>>0?1:0),M=F.low=M+v,F.high=X+y+(M>>>0<v>>>0?1:0),N=G.low=N+w,G.high=Y+z+(N>>>0<w>>>0?1:0),O=e.low=O+x,e.high=Z+Q+(O>>>0<x>>>0?1:0);},_doFinalize:function(){var c=this._data,a=c.words,d=8*this._nDataBytes,b=8*c.sigBytes;return a[b>>>5]|=128<<24-b%32,a[(b+128>>>10<<5)+30]=Math.floor(d/4294967296),a[(b+128>>>10<<5)+31]=d,c.sigBytes=4*a.length,this._process(),this._hash.toX32();},clone:function(){var a=f.clone.call(this);return a._hash=this._hash.clone(),a;},blockSize:32}),e.SHA512=f._createHelper(c),e.HmacSHA512=f._createHmacHelper(c);}());