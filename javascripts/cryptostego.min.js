/* CryptoStego @ Jeffery / GNU AGPL v3.0 or later */
var t=function(t){null==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(t)};t.prototype.init_genrand=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},t.prototype.init_by_array=function(t,r){var n,i,e;for(this.init_genrand(19650218),n=1,i=0,e=this.N>r?this.N:r;e;e--){var a=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&a)>>>16)<<16)+1664525*(65535&a))+t[i]+i,this.mt[n]>>>=0,i++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),i>=r&&(i=0)}for(e=this.N-1;e;e--){a=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1566083941*((4294901760&a)>>>16)<<16)+1566083941*(65535&a))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648},t.prototype.genrand_int32=function(){var t,r=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_genrand(5489),n=0;n<this.N-this.M;n++)t=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^t>>>1^r[1&t];for(;n<this.N-1;n++)t=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^t>>>1^r[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^r[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0};var r=r||function(t,r){var n={},i=n.lib={},e=function(){},a=i.Base={extend:function(t){e.prototype=this;var r=new e;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=a.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=null!=r?r:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var r=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var e=0;e<t;e++)r[i+e>>>2]|=(n[e>>>2]>>>24-e%4*8&255)<<24-(i+e)%4*8;else if(65535<n.length)for(e=0;e<t;e+=4)r[i+e>>>2]=n[e>>>2];else r.push.apply(r,n);return this.sigBytes+=t,this},clamp:function(){var r=this.words,n=this.sigBytes;r[n>>>2]&=4294967295<<32-n%4*8,r.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(r){for(var n=[],i=0;i<r;i+=4)n.push(4294967296*t.random()|0);return new o.init(n,r)}}),h=n.enc={},s=h.Hex={stringify:function(t){var r=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var e=r[i>>>2]>>>24-i%4*8&255;n.push((e>>>4).toString(16)),n.push((15&e).toString(16))}return n.join("")},parse:function(t){for(var r=t.length,n=[],i=0;i<r;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new o.init(n,r/2)}},u=h.Latin1={stringify:function(t){var r=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++)n.push(String.fromCharCode(r[i>>>2]>>>24-i%4*8&255));return n.join("")},parse:function(t){for(var r=t.length,n=[],i=0;i<r;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new o.init(n,r)}},f=h.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},c=i.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(r){var n=this._data,i=n.words,e=n.sigBytes,a=this.blockSize,h=e/(4*a);if(r=(h=r?t.ceil(h):t.max((0|h)-this._minBufferSize,0))*a,e=t.min(4*r,e),r){for(var s=0;s<r;s+=a)this._doProcessBlock(i,s);s=i.splice(0,r),n.sigBytes-=e}return new o.init(s,e)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=c.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(r,n){return new t.init(n).finalize(r)}},_createHmacHelper:function(t){return function(r,n){return new l.HMAC.init(t,n).finalize(r)}}});var l=n.algo={};return n}(Math);function n(t){for(var r,n,i,e=[],a=0,o=t.length;a<o;)r=t[a],n=t[a+1],i=t[a+2],128>r?(e.push(String.fromCharCode(r)),a+=1):191<r&&r<224?(e.push(String.fromCharCode((31&r)<<6|63&n)),a+=2):(e.push(String.fromCharCode((15&r)<<12|(63&n)<<6|63&i)),a+=3);return e.join("")}function i(t){var r,n,i=[],e=0;for(r=(t=encodeURI(t)).length;e<r;)n=t[e],e+=1,"%"!==n?i.push(n.charCodeAt(0)):(n=t[e]+t[e+1],i.push(parseInt(n,16)),e+=2);return i}function e(t,r,n){return[.299*t+.587*r+.114*n,128-.168736*t-.331264*r+.5*n,128+.5*t-.418688*r-.081312*n]}function a(t,r,n){return[t+1.402*(n-128),t-.344136*(r-128)-.714136*(n-128),t+1.772*(r-128)]}function o(n,i){for(var e,a=Array.from(Array(i).keys()),o=[],h=r.SHA512(n).words.reduce(function(t,r){return t+Math.abs(r)},0),s=new t(h),u=i;u>0;u--)e=s.genrand_int32()%u,o.push(a[e]),a[e]=a[u-1];return o}function h(t){for(var r,n,i,e=Array(64).fill(0),a=0;a<8;a++)for(var o=0;o<8;o++){r=0==a?1/Math.sqrt(2):1,n=0==o?1/Math.sqrt(2):1,i=0;for(var h=0;h<8;h++)for(var s=0;s<8;s++)i+=t[8*h+s]*Math.cos((2*h+1)*a*Math.PI/16)*Math.cos((2*s+1)*o*Math.PI/16);e[8*a+o]=.25*r*n*i}return e}function s(t){var r;result=Array(64).fill(0);for(var n=0;n<8;n++)for(var i=0;i<8;i++){r=0;for(var e=0;e<8;e++)for(var a=0;a<8;a++)r+=(0==e?1/Math.sqrt(2):1)*(0==a?1/Math.sqrt(2):1)*t[8*e+a]*Math.cos((2*n+1)*e*Math.PI/16)*Math.cos((2*i+1)*a*Math.PI/16);result[8*n+i]=.25*r}return result}function u(t){for(var r=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++)r[n]*=t;return r}function f(t,r,n,i){if(r.length!=i.length)throw"LOC and ENCODE_BITS have different sizes! This is a bug in code!";for(var e,a,o,h=u(t),s=Array(64).fill(0),f=0;f<r.length;f++)e=n[r[f]]/h[r[f]],a=Math.floor(e),Math.abs(a%2)!=i[f]&&(a-=1),o=Math.ceil(e),Math.abs(o%2)!=i[f]&&(o+=1),e-a>o-e&&(a=o),s[r[f]]=a*h[r[f]]-n[r[f]];return s}function c(t,r,n){for(var i=u(t),e=[],a=0;a<r.length;a++)e.push(Math.abs(Math.round(n[r[a]]/i[r[a]])%2));return e}function l(t){for(var r=Array(64),n=0;n<8;n++)for(var i=0;i<8;i++)r[8*n+i]=(t[2*n*8+2*i]+t[8*(2*n+1)+2*i]+t[2*n*8+2*i+1]+t[8*(2*n+1)+2*i+1])/4;return r}function d(t){for(var r=Array(256),n=0;n<16;n++)for(var i=0;i<16;i++)r[16*n+i]=t[8*Math.floor(n/2)+Math.floor(i/2)];return r}function g(t){return(t=(t=Math.round(t))>255?255:t)<0?0:t}function v(t,r){for(var n=i(t),e=Array(),a=n.length,o=0;o<a;o++)for(var h=128;h>0;h=Math.floor(h/2))if(Math.floor(n[o]/h)){for(var s=0;s<r;s++)e.push(1);n[o]-=h}else for(s=0;s<r;s++)e.push(0);for(h=0;h<24;h++)for(o=0;o<r;o++)e.push(1);return e}function p(t,r){function i(t){for(var r=t.length,n=0,i=0;i<r;i++)n+=t[i];return Math.round(n/r)}for(var e,a,o=Array(),h=Math.floor(Math.floor(t.length/r)/8),s=0;s<h;s++){e=0,a=128;for(var u=0;u<8;u++)e+=i(t.slice((8*s+u)*r,(8*s+u+1)*r))*a,a=Math.floor(a/2);if(255==e)break;o.push(e)}return n(o)}function m(t,r,n,i,e){for(var a=Array(r*r),o=0;o<r;o++)for(var h=0;h<r;h++)a[o*r+h]=t[(n+o)*e+i+h];return a}function w(t,r,n,i,e,a){for(var o=0;o<r;o++)for(var h=0;h<r;h++)t[(n+o)*e+i+h]=a[o*r+h]}function y(t,r,n){var i=t.length;if(t.length>n)throw"Can not hold this many data!";for(var e=Array(n),a=0;a<n;a++)e[a]=Math.floor(2*Math.random());var h=o(r,n);for(a=0;a<i;a++)e[h[a]]=t[a];return e}function M(t,r,n,i,e,a){var o,u=Math.floor(n/8),c=Math.floor(r/8),l=a.length;if(l*(u*c-1)!=i.length)throw"Image size does not match data size (Y channel)";for(var d=0;d<u;d++)for(var g=0;g<c;g++){var v=m(t,8,8*d,8*g,r),p=h(v);if(0!=d||0!=g){var y=f(e,a,p.map(function(t,r){return t-o[r]}),i.slice(l*(d*c+g-1),l*(d*c+g)));w(t,8,8*d,8*g,r,v=s(p=p.map(function(t,r){return t+y[r]})))}else o=p}}function _(t,r,n,i,e,a){var o,u=Math.floor(n/16),c=Math.floor(r/16),g=a.length;if(g*(u*c-1)!=i.length)throw"Image size does not match data size (CbCr channel)";for(var v=0;v<u;v++)for(var p=0;p<c;p++){var y=m(t,16,16*v,16*p,r),M=l(y),_=h(M);if(0!=v||0!=p){var A=f(e,a,_.map(function(t,r){return t-o[r]}),i.slice(g*(v*c+p-1),g*(v*c+p))),S=s(_=_.map(function(t,r){return t+A[r]})).map(function(t,r){return t-M[r]});S=d(S),w(t,16,16*v,16*p,r,y=y.map(function(t,r){return t+S[r]}))}else o=_}}function A(t,r){function n(t){return t%2==1?t-1:t}function i(t){return t%2==1?t:t+1}for(var e=0,a=0;a<t.data.length;a+=4)t.data[a]=r[e]?i(t.data[a]):n(t.data[a]),t.data[a+1]=r[e+1]?i(t.data[a+1]):n(t.data[a+1]),t.data[a+2]=r[e+2]?i(t.data[a+2]):n(t.data[a+2]),t.data[a+3]=255,e+=3}function S(t,r,n,i,e){var a=e?16:8;return[i?(Math.floor(r/8)*Math.floor(t/8)-1)*n.length:0,(Math.floor(r/a)*Math.floor(t/a)-1)*n.length]}function B(t,r,n,i,o,h,s,u){for(var f=S(r,n,h,s,u),c=f[0],l=f[1],d=Array(),v=Array(),p=Array(),m=0;m<t.data.length;m+=4){var w=e(t.data[m],t.data[m+1],t.data[m+2]);d.push(w[0]),v.push(w[1]),p.push(w[2])}s&&M(d,r,n,i.slice(0,c),o,h);var y=u?_:M;y(v,r,n,i.slice(c,c+l),o,h),y(p,r,n,i.slice(c+l,c+l+l),o,h);var A=0;for(m=0;m<t.data.length;m+=4){var B=a(d[A],v[A],p[A]);t.data[m]=g(B[0]),t.data[m+1]=g(B[1]),t.data[m+2]=g(B[2]),A+=1}}function writeMsgToCanvas_base(t,r,n,i,e,a,o,h,s){i=void 0!==i&&i,n=void 0===n?"":n,e=void 0===e?5:e,a=void 0===a?30:a,o=void 0===o?[1,2,8,9,10,16,17]:o,h=void 0===h||h,s=void 0===s||s;try{var u=document.getElementById(t),f=u.getContext("2d"),c=f.getImageData(0,0,u.width,u.height),l=3*Math.floor(c.data.length/4);if(i){var d=S(u.width,u.height,o,h,s);l=d[0]+2*d[1]}var g=v(r,e);return g=y(g,n,l),i?B(c,u.width,u.height,g,a,o,h,s):A(c,g),f.putImageData(c,0,0),!0}catch(t){return t}}function I(t,r){for(var n=t.length,i=Array(n),e=o(r,n),a=0;a<n;a++)i[a]=t[e[a]];return i}function C(t){for(var r=Array(),n=0;n<t.data.length;n+=4)r.push(t.data[n]%2==1?1:0),r.push(t.data[n+1]%2==1?1:0),r.push(t.data[n+2]%2==1?1:0);return r}function E(t,r,n,i,e){for(var a,o=Math.floor(n/8),s=Math.floor(r/8),u=(e.length,Array()),f=0;f<o;f++)for(var l=0;l<s;l++){var d=h(m(t,8,8*f,8*l,r));0!=f||0!=l?u.push(c(i,e,d.map(function(t,r){return t-a[r]}))):a=d}return[].concat.apply([],u)}function N(t,r,n,i,e){for(var a,o=Math.floor(n/16),s=Math.floor(r/16),u=(e.length,Array()),f=0;f<o;f++)for(var d=0;d<s;d++){var g=m(t,16,16*f,16*d,r),v=h(g=l(g));0!=f||0!=d?u.push(c(i,e,v.map(function(t,r){return t-a[r]}))):a=v}return[].concat.apply([],u)}function R(t,r,n,i,a,o,h){for(var s=Array(),u=Array(),f=Array(),c=Array(),l=0;l<t.data.length;l+=4){var d=e(t.data[l],t.data[l+1],t.data[l+2]);s.push(d[0]),u.push(d[1]),f.push(d[2])}o&&c.push(E(s,r,n,i,a));var g=h?N:E;return c.push(g(u,r,n,i,a)),c.push(g(f,r,n,i,a)),[].concat.apply([],c)}function readMsgFromCanvas_base(t,r,n,i,e,a,o,h){var s,u;n=void 0!==n&&n,r=void 0===r?"":r,i=void 0===i?5:i,e=void 0===e?30:e,a=void 0===a?[1,2,8,9,10,16,17]:a,o=void 0===o||o,h=void 0===h||h;try{u=(s=document.getElementById(t)).getContext("2d").getImageData(0,0,s.width,s.height)}catch(t){return[!1,t]}try{var f=n?R(u,s.width,s.height,e,a,o,h):C(u),c=p(f=I(f,r),i);return null==c?[!1,"Message does not decrypt. Maybe due to (1) wrong password / enc method. (2) corrupted file"]:[!0,c]}catch(t){return[!1,"Message does not decrypt. Maybe due to (1) wrong password / enc method. (2) corrupted file"]}}function writeMsgToCanvas(t,r,n,i){var e=writeMsgToCanvas_base;switch(i=void 0===i?0:parseInt(i)){case 1:return e(t,r,n,!0,23,2,[2,9,16],!0,!1);case 2:return e(t,r,n,!0,17,3,[1,8],!0,!1);case 3:return e(t,r,n,!0,17,5,[1,8],!0,!1);case 4:return e(t,r,n,!0,5,5,[0],!0,!1);case 5:return e(t,r,n,!0,5,6,[0],!0,!0);case 0:default:return e(t,r,n,!1,1)}}function readMsgFromCanvas(t,r,n){var i=readMsgFromCanvas_base;switch(n=void 0===n?0:parseInt(n)){case 1:return i(t,r,!0,23,2,[2,9,16],!0,!1)[1];case 2:return i(t,r,!0,17,3,[1,8],!0,!1)[1];case 3:return i(t,r,!0,17,5,[1,8],!0,!1)[1];case 4:return i(t,r,!0,5,5,[0],!0,!1)[1];case 5:return i(t,r,!0,5,6,[0],!0,!0)[1];case 0:default:return i(t,r,!1,1)[1]}}function loadIMGtoCanvas(t,r,n,i){i=void 0===i?0:i;var e=document.getElementById(t);if(!e.files||!e.files[0])return alert("NO IMG FILE SELECTED"),"ERROR PROCESSING IMAGE!";var a=e.files[0],o=new FileReader;o.onload=function(t){var e=t.target.result,a=new Image;a.onload=function(){var t=a.width,e=a.height;i>0&&(t>i&&(e*=i/t,t=i),e>i&&(t*=i/e,e=i),t=Math.floor(t),e=Math.floor(e));var o=document.createElement("canvas");o.id=r,o.width=t,o.height=e,o.style.display="none",document.getElementsByTagName("body")[0].appendChild(o),o.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,t,e),n(),document.body.removeChild(o)},a.src=e},o.readAsDataURL(a)}!function(t){var n,i=(n=r).lib,e=i.Base,a=i.WordArray;(n=n.x64={}).Word=e.extend({init:function(t,r){this.high=t,this.low=r}}),n.WordArray=e.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=null!=r?r:8*t.length},toX32:function(){for(var t=this.words,r=t.length,n=[],i=0;i<r;i++){var e=t[i];n.push(e.high),n.push(e.low)}return a.create(n,this.sigBytes)},clone:function(){for(var t=e.clone.call(this),r=t.words=this.words.slice(0),n=r.length,i=0;i<n;i++)r[i]=r[i].clone();return t}})}(),function(){function t(){return e.create.apply(e,arguments)}for(var n=r,i=n.lib.Hasher,e=(o=n.x64).Word,a=o.WordArray,o=n.algo,h=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],s=[],u=0;80>u;u++)s[u]=t();o=o.SHA512=i.extend({_doReset:function(){this._hash=new a.init([new e.init(1779033703,4089235720),new e.init(3144134277,2227873595),new e.init(1013904242,4271175723),new e.init(2773480762,1595750129),new e.init(1359893119,2917565137),new e.init(2600822924,725511199),new e.init(528734635,4215389547),new e.init(1541459225,327033209)])},_doProcessBlock:function(t,r){for(var n=(c=this._hash.words)[0],i=c[1],e=c[2],a=c[3],o=c[4],u=c[5],f=c[6],c=c[7],l=n.high,d=n.low,g=i.high,v=i.low,p=e.high,m=e.low,w=a.high,y=a.low,M=o.high,_=o.low,A=u.high,S=u.low,B=f.high,I=f.low,C=c.high,E=c.low,N=l,R=d,x=g,b=v,P=p,z=m,H=w,O=y,D=M,U=_,W=A,L=S,k=B,K=I,T=C,F=E,q=0;80>q;q++){var X=s[q];if(16>q)var j=X.high=0|t[r+2*q],G=X.low=0|t[r+2*q+1];else{j=((G=(j=s[q-15]).high)>>>1|($=j.low)<<31)^(G>>>8|$<<24)^G>>>7;var $=($>>>1|G<<31)^($>>>8|G<<24)^($>>>7|G<<25),Y=((G=(Y=s[q-2]).high)>>>19|(J=Y.low)<<13)^(G<<3|J>>>29)^G>>>6,J=(J>>>19|G<<13)^(J<<3|G>>>29)^(J>>>6|G<<26),Q=(G=s[q-7]).high,V=(Z=s[q-16]).high,Z=Z.low;j=(j=(j=j+Q+((G=$+G.low)>>>0<$>>>0?1:0))+Y+((G=G+J)>>>0<J>>>0?1:0))+V+((G=G+Z)>>>0<Z>>>0?1:0);X.high=j,X.low=G}Q=D&W^~D&k,Z=U&L^~U&K,X=N&x^N&P^x&P;var tt=R&b^R&z^b&z,rt=($=(N>>>28|R<<4)^(N<<30|R>>>2)^(N<<25|R>>>7),Y=(R>>>28|N<<4)^(R<<30|N>>>2)^(R<<25|N>>>7),(J=h[q]).high),nt=J.low;V=T+((D>>>14|U<<18)^(D>>>18|U<<14)^(D<<23|U>>>9))+((J=F+((U>>>14|D<<18)^(U>>>18|D<<14)^(U<<23|D>>>9)))>>>0<F>>>0?1:0),T=k,F=K,k=W,K=L,W=D,L=U,D=H+(V=(V=(V=V+Q+((J=J+Z)>>>0<Z>>>0?1:0))+rt+((J=J+nt)>>>0<nt>>>0?1:0))+j+((J=J+G)>>>0<G>>>0?1:0))+((U=O+J|0)>>>0<O>>>0?1:0)|0,H=P,O=z,P=x,z=b,x=N,b=R,N=V+(X=$+X+((G=Y+tt)>>>0<Y>>>0?1:0))+((R=J+G|0)>>>0<J>>>0?1:0)|0}d=n.low=d+R,n.high=l+N+(d>>>0<R>>>0?1:0),v=i.low=v+b,i.high=g+x+(v>>>0<b>>>0?1:0),m=e.low=m+z,e.high=p+P+(m>>>0<z>>>0?1:0),y=a.low=y+O,a.high=w+H+(y>>>0<O>>>0?1:0),_=o.low=_+U,o.high=M+D+(_>>>0<U>>>0?1:0),S=u.low=S+L,u.high=A+W+(S>>>0<L>>>0?1:0),I=f.low=I+K,f.high=B+k+(I>>>0<K>>>0?1:0),E=c.low=E+F,c.high=C+T+(E>>>0<F>>>0?1:0)},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),r[31+(i+128>>>10<<5)]=n,t.sigBytes=4*r.length,this._process(),this._hash.toX32()},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),n.SHA512=i._createHelper(o),n.HmacSHA512=i._createHmacHelper(o)}();